package com.bkkbnjabar.sipenting.data.remote.mapper

import com.bkkbnjabar.sipenting.data.local.entity.*
import com.bkkbnjabar.sipenting.data.remote.model.*

// --- LookupItem Mapper ---
fun LookupItemDto.toEntity(type: String): LookupItemEntity = LookupItemEntity(
    serverId = this.id,
    name = this.name,
    type = type,
    isRisky = this.isRisky ?: false,
    description = this.description
)

// --- Pregnant Mother Mappers ---
fun PersonDto.toPregnantMotherEntity(): PregnantMotherEntity = PregnantMotherEntity(
    id = this.id,
    name = this.name ?: "",
    nik = this.nik ?: "",
    dateOfBirth = this.dateOfBirth ?: "",
    phoneNumber = this.phoneNumber,
    provinsiName = this.provinsiName ?: "",
    provinsiId = this.provinsiId ?: 0,
    kabupatenName = this.kabupatenName ?: "",
    kabupatenId = this.kabupatenId ?: 0,
    kecamatanName = this.kecamatanName ?: "",
    kecamatanId = this.kecamatanId ?: 0,
    kelurahanName = this.kelurahanName ?: "",
    kelurahanId = this.kelurahanId ?: 0,
    rwName = this.rwName ?: "",
    rwId = this.rwId ?: 0,
    rtName = this.rtName ?: "",
    rtId = this.rtId ?: 0,
    fullAddress = this.fullAddress ?: ""
)

fun PregnantMotherEntity.toUploadRequest(): PersonUploadRequest = PersonUploadRequest(
    name = this.name,
    nik = this.nik,
    date_of_birth = this.dateOfBirth,
    phone_number = this.phoneNumber,
    provinsi_id = this.provinsiId,
    kabupaten_id = this.kabupatenId,
    kecamatan_id = this.kecamatanId,
    kelurahan_id = this.kelurahanId,
    rw_id = this.rwId,
    rt_id = this.rtId,
    full_address = this.fullAddress
)

// --- Breastfeeding Mother Mappers ---
fun PersonDto.toBreastfeedingMotherEntity(): BreastfeedingMotherEntity = BreastfeedingMotherEntity(
    id = this.id,
    name = this.name ?: "",
    nik = this.nik ?: "",
    dateOfBirth = this.dateOfBirth ?: "",
    phoneNumber = this.phoneNumber,
    provinsiName = this.provinsiName ?: "",
    provinsiId = this.provinsiId ?: 0,
    kabupatenName = this.kabupatenName ?: "",
    kabupatenId = this.kabupatenId ?: 0,
    kecamatanName = this.kecamatanName ?: "",
    kecamatanId = this.kecamatanId ?: 0,
    kelurahanName = this.kelurahanName ?: "",
    kelurahanId = this.kelurahanId ?: 0,
    rwName = this.rwName ?: "",
    rwId = this.rwId ?: 0,
    rtName = this.rtName ?: "",
    rtId = this.rtId ?: 0,
    fullAddress = this.fullAddress ?: ""
)

fun BreastfeedingMotherEntity.toUploadRequest(): PersonUploadRequest = PersonUploadRequest(
    name = this.name,
    nik = this.nik,
    date_of_birth = this.dateOfBirth,
    phone_number = this.phoneNumber,
    provinsi_id = this.provinsiId,
    kabupaten_id = this.kabupatenId,
    kecamatan_id = this.kecamatanId,
    kelurahan_id = this.kelurahanId,
    rw_id = this.rwId,
    rt_id = this.rtId,
    full_address = this.fullAddress
)

// --- Child's Mother Mappers ---
fun PersonDto.toChildMotherEntity(): ChildMotherEntity = ChildMotherEntity(
    id = this.id,
    name = this.name ?: "",
    nik = this.nik ?: "",
    dateOfBirth = this.dateOfBirth ?: "",
    phoneNumber = this.phoneNumber,
    provinsiName = this.provinsiName ?: "",
    provinsiId = this.provinsiId ?: 0,
    kabupatenName = this.kabupatenName ?: "",
    kabupatenId = this.kabupatenId ?: 0,
    kecamatanName = this.kecamatanName ?: "",
    kecamatanId = this.kecamatanId ?: 0,
    kelurahanName = this.kelurahanName ?: "",
    kelurahanId = this.kelurahanId ?: 0,
    rwName = this.rwName ?: "",
    rwId = this.rwId ?: 0,
    rtName = this.rtName ?: "",
    rtId = this.rtId ?: 0,
    fullAddress = this.fullAddress ?: ""
)

fun ChildMotherEntity.toUploadRequest(): PersonUploadRequest = PersonUploadRequest(
    name = this.name,
    nik = this.nik,
    date_of_birth = this.dateOfBirth,
    phone_number = this.phoneNumber,
    provinsi_id = this.provinsiId,
    kabupaten_id = this.kabupatenId,
    kecamatan_id = this.kecamatanId,
    kelurahan_id = this.kelurahanId,
    rw_id = this.rwId,
    rt_id = this.rtId,
    full_address = this.fullAddress
)

// --- Child Mappers ---
fun PersonDto.toChildEntity(): ChildEntity = ChildEntity(
    id = this.id,
    motherId = 0, // This is resolved in the repository
    name = this.name ?: "",
    nik = this.nik ?: "",
    dateOfBirth = this.dateOfBirth ?: "",
    phoneNumber = this.phoneNumber,
    provinsiName = this.provinsiName ?: "",
    provinsiId = this.provinsiId ?: 0,
    kabupatenName = this.kabupatenName ?: "",
    kabupatenId = this.kabupatenId ?: 0,
    kecamatanName = this.kecamatanName ?: "",
    kecamatanId = this.kecamatanId ?: 0,
    kelurahanName = this.kelurahanName ?: "",
    kelurahanId = this.kelurahanId ?: 0,
    rwName = this.rwName ?: "",
    rwId = this.rwId ?: 0,
    rtName = this.rtName ?: "",
    rtId = this.rtId ?: 0,
    fullAddress = this.fullAddress ?: ""
)

fun ChildEntity.toUploadRequest(motherServerId: String): PersonUploadRequest = PersonUploadRequest(
    mother_id = motherServerId,
    name = this.name,
    nik = this.nik,
    date_of_birth = this.dateOfBirth,
    phone_number = this.phoneNumber,
    provinsi_id = this.provinsiId,
    kabupaten_id = this.kabupatenId,
    kecamatan_id = this.kecamatanId,
    kelurahan_id = this.kelurahanId,
    rw_id = this.rwId,
    rt_id = this.rtId,
    full_address = this.fullAddress
)

// --- Child Visit Mappers ---
fun VisitDto.toChildVisitEntity(): ChildVisitsEntity = ChildVisitsEntity(
    id = this.id,
    childId = 0, // This is resolved in the repository
    visitDate = this.visitDate,
    pregnancyAgeWhenChildbirth = this.pregnancyAgeWhenChildbirth,
    weightBirth = this.weightBirth,
    heightBirth = this.heightBirth,
    isAsiExclusive = this.isAsiExclusive,
    onContraception = this.onContraception ?: false,
    contraceptionTypeId = this.contraceptionTypeId,
    contraceptionReasonForUse = this.contraceptionReasonForUse,
    contraceptionRTypeId = this.contraceptionRTypeId,
    measurementDate = this.measurementDate,
    weightMeasurement = this.weightMeasurement,
    heightMeasurement = this.heightMeasurement,
    isOngoingAsi = this.isOngoingAsi,
    isMpasi = this.isMpasi,
    isKkaFilled = this.isKkaFilled,
    kkaResult = this.kkaResult,
    isExposedToCigarettes = this.isExposedToCigarettes,
    isPosyanduMonth = this.isPosyanduMonth,
    isBkbMonth = this.isBkbMonth,
    isCounselingReceived = this.isCounselingReceived,
    isReceivedMbg = this.isReceivedMbg,
    headCircumference = this.headCircumference,
    counselingTypeId = this.counselingTypeId,
    immunizationsGiven = this.immunizationsGiven,
    mainSourceOfDrinkingWater = this.mainSourceOfDrinkingWater,
    mainSourceOfDrinkingWaterOther = this.mainSourceOfDrinkingWaterOther,
    defecationFacility = this.defecationFacility,
    defecationFacilityOther = this.defecationFacilityOther,
    facilitatingReferralServiceStatus = this.facilitatingReferralServiceStatus,
    facilitatingSocialAssistanceStatus = this.facilitatingSocialAssistanceStatus,
    socialAssistanceFacilitationOptions = this.socialAssistanceFacilitationOptions,
    socialAssistanceFacilitationOptionsOther = this.socialAssistanceFacilitationOptionsOther,
    pregnantMotherStatusId = this.pregnantMotherStatusId,
    nextVisitDate = this.nextVisitDate,
    tpkNotes = this.tpkNotes,
    imagePath1 = this.imagePath1,
    imagePath2 = this.imagePath2,
    latitude = this.latitude,
    longitude = this.longitude,
    createdAt = System.currentTimeMillis(),
    updatedAt = System.currentTimeMillis()
)

fun ChildVisitsEntity.toUploadRequest(childServerId: String): VisitUploadRequest = VisitUploadRequest(
    parent_id = childServerId,
    visit_date = this.visitDate,
    pregnancy_age_when_childbirth = this.pregnancyAgeWhenChildbirth,
    weight_birth = this.weightBirth,
    height_birth = this.heightBirth,
    is_asi_exclusive = this.isAsiExclusive,
    on_contraception = this.onContraception,
    contraception_type_id = this.contraceptionTypeId,
    contraception_reason_for_use = this.contraceptionReasonForUse,
    contraception_rejection_reason_id = this.contraceptionRTypeId,
    measurement_date = this.measurementDate,
    weight_measurement = this.weightMeasurement,
    height_measurement = this.heightMeasurement,
    is_ongoing_asi = this.isOngoingAsi,
    is_mpasi = this.isMpasi,
    is_kka_filled = this.isKkaFilled,
    kka_result = this.kkaResult,
    is_exposed_to_cigarettes = this.isExposedToCigarettes,
    is_posyandu_month = this.isPosyanduMonth,
    is_bkb_month = this.isBkbMonth,
    is_counseling_received = this.isCounselingReceived,
    is_received_mbg = this.isReceivedMbg,
    head_circumference = this.headCircumference,
    counseling_type_id = this.counselingTypeId,
    immunizations_given = this.immunizationsGiven,
    main_source_of_drinking_water = this.mainSourceOfDrinkingWater,
    main_source_of_drinking_water_other = this.mainSourceOfDrinkingWaterOther,
    defecation_facility = this.defecationFacility,
    defecation_facility_other = this.defecationFacilityOther,
    facilitating_referral_service_status = this.facilitatingReferralServiceStatus,
    facilitating_social_assistance_status = this.facilitatingSocialAssistanceStatus,
    social_assistance_facilitation_options = this.socialAssistanceFacilitationOptions,
    social_assistance_facilitation_options_other = this.socialAssistanceFacilitationOptionsOther,
    pregnant_mother_status_id = this.pregnantMotherStatusId,
    next_visit_date = this.nextVisitDate,
    tpk_notes = this.tpkNotes,
    image_path_1 = this.imagePath1,
    image_path_2 = this.imagePath2,
    latitude = this.latitude,
    longitude = this.longitude
)

// --- Pregnant Mother Visit Mappers ---
fun VisitDto.toPregnantMotherVisitEntity(): PregnantMotherVisitsEntity = PregnantMotherVisitsEntity(
    id = this.id,
    pregnantMotherLocalId = 0, // Resolved in repository
    visitDate = this.visitDate ?: "",
    childNumber = null, // These fields are form-specific, not from server GET
    dateOfBirthLastChild = null,
    pregnancyWeekAge = null,
    weightTrimester1 = null,
    currentHeight = null,
    currentWeight = null,
    isHbChecked = false,
    hemoglobinLevel = null,
    hemoglobinLevelReason = null,
    upperArmCircumference = null,
    isTwin = false,
    numberOfTwins = null,
    isEstimatedFetalWeightChecked = false,
    tbj = null,
    isExposedToCigarettes = this.isExposedToCigarettes ?: false,
    isCounselingReceived = this.isCounselingReceived ?: false,
    counselingTypeId = this.counselingTypeId,
    isIronTablesReceived = false,
    isIronTablesTaken = false,
    facilitatingReferralServiceStatus = this.facilitatingReferralServiceStatus,
    facilitatingSocialAssistanceStatus = this.facilitatingSocialAssistanceStatus,
    nextVisitDate = this.nextVisitDate,
    tpkNotes = this.tpkNotes,
    isAlive = true,
    isGivenBirth = false,
    givenBirthStatusId = null,
    pregnantMotherStatusId = this.pregnantMotherStatusId,
    diseaseHistory = null,
    mainSourceOfDrinkingWater = this.mainSourceOfDrinkingWater,
    mainSourceOfDrinkingWaterOther = this.mainSourceOfDrinkingWaterOther,
    defecationFacility = this.defecationFacility,
    defecationFacilityOther = this.defecationFacilityOther,
    socialAssistanceFacilitationOptions = this.socialAssistanceFacilitationOptions,
    socialAssistanceFacilitationOptionsOther = this.socialAssistanceFacilitationOptionsOther,
    createdAt = System.currentTimeMillis(),
    imagePath1 = this.imagePath1,
    imagePath2 = this.imagePath2,
    latitude = this.latitude,
    longitude = this.longitude,
    isReceivedMbg = this.isReceivedMbg ?: false,
    isTfuMeasured = null,
    tfu = null
)

fun PregnantMotherVisitsEntity.toUploadRequest(motherServerId: String): VisitUploadRequest = VisitUploadRequest(
    parent_id = motherServerId,
    visit_date = this.visitDate,
    pregnancy_age_when_childbirth = null,
    weight_birth = null,
    height_birth = null,
    is_asi_exclusive = null,
    on_contraception = null,
    contraception_type_id = null,
    contraception_reason_for_use = null,
    contraception_rejection_reason_id = null,
    measurement_date = null,
    weight_measurement = null,
    height_measurement = null,
    is_ongoing_asi = null,
    is_mpasi = null,
    is_kka_filled = null,
    kka_result = null,
    is_exposed_to_cigarettes = null,
    is_posyandu_month = null,
    is_bkb_month = null,
    is_counseling_received = null,
    is_received_mbg = null,
    head_circumference = null,
    counseling_type_id = null,
    immunizations_given = null,
    main_source_of_drinking_water = this.mainSourceOfDrinkingWater,
    main_source_of_drinking_water_other = this.mainSourceOfDrinkingWaterOther,
    defecation_facility = this.defecationFacility,
    defecation_facility_other = this.defecationFacilityOther,
    facilitating_referral_service_status = this.facilitatingReferralServiceStatus,
    facilitating_social_assistance_status = this.facilitatingSocialAssistanceStatus,
    social_assistance_facilitation_options = this.socialAssistanceFacilitationOptions,
    social_assistance_facilitation_options_other = this.socialAssistanceFacilitationOptionsOther,
    pregnant_mother_status_id = this.pregnantMotherStatusId,
    next_visit_date = this.nextVisitDate,
    tpk_notes = this.tpkNotes,
    image_path_1 = this.imagePath1,
    image_path_2 = this.imagePath2,
    latitude = this.latitude,
    longitude = this.longitude
)

// --- Breastfeeding Mother Visit Mappers ---
fun VisitDto.toBreastfeedingMotherVisitEntity(): BreastfeedingMotherVisitsEntity = BreastfeedingMotherVisitsEntity(
    id = this.id,
    breastfeedingMotherId = 0, // Resolved in repository
    visitDate = this.visitDate,
    lastBirthDate = null,
    modeOfDelivery = null,
    isTwin = null,
    babyStatus = null,
    isPostpartumComplication = null,
    postpartumComplication = null,
    postpartumComplicationOther = null,
    isExposedToCigarettes = false,
    isCounselingReceived = false,
    counselingTypeId = this.counselingTypeId,
    isIronTablesReceived = false,
    isIronTablesTaken = false,
    facilitatingReferralServiceStatus = this.facilitatingReferralServiceStatus,
    facilitatingSocialAssistanceStatus = this.facilitatingSocialAssistanceStatus,
    nextVisitDate = this.nextVisitDate,
    tpkNotes = this.tpkNotes,
    breastfeedingMotherStatusId = this.pregnantMotherStatusId,
    mainSourceOfDrinkingWater = this.mainSourceOfDrinkingWater,
    mainSourceOfDrinkingWaterOther = this.mainSourceOfDrinkingWaterOther,
    defecationFacility = this.defecationFacility,
    defecationFacilityOther = this.defecationFacilityOther,
    socialAssistanceFacilitationOptions = this.socialAssistanceFacilitationOptions,
    socialAssistanceFacilitationOptionsOther = this.socialAssistanceFacilitationOptionsOther,
    imagePath1 = this.imagePath1,
    imagePath2 = this.imagePath2,
    latitude = this.latitude,
    longitude = this.longitude,
    isReceivedMbg = false,
    isAsiExclusive = false,
    onContraception = false,
    contraceptionTypeId = this.contraceptionTypeId,
    contraceptionReasonForUse = this.contraceptionReasonForUse,
    deliveryPlaceId = null,
    birthAssistantId = null,
    currentHeight = null,
    currentWeight = null,
    createdAt = 0,
    contraceptionRTypeId = null
)

fun BreastfeedingMotherVisitsEntity.toUploadRequest(motherServerId: String): VisitUploadRequest = VisitUploadRequest(
    parent_id = motherServerId,
    visit_date = this.visitDate,
    pregnancy_age_when_childbirth = null,
    weight_birth = null,
    height_birth = null,
    is_asi_exclusive = this.isAsiExclusive,
    on_contraception = this.onContraception,
    contraception_type_id = this.contraceptionTypeId,
    contraception_reason_for_use = this.contraceptionReasonForUse,
    contraception_rejection_reason_id = null,
    measurement_date = null,
    weight_measurement = this.currentWeight,
    height_measurement = this.currentHeight,
    is_ongoing_asi = null,
    is_mpasi = null,
    is_kka_filled = null,
    kka_result = null,
    is_exposed_to_cigarettes = this.isExposedToCigarettes,
    is_posyandu_month = null,
    is_bkb_month = null,
    is_counseling_received = this.isCounselingReceived,
    is_received_mbg = this.isReceivedMbg,
    head_circumference = null,
    counseling_type_id = this.counselingTypeId,
    immunizations_given = null,
    main_source_of_drinking_water = this.mainSourceOfDrinkingWater,
    main_source_of_drinking_water_other = this.mainSourceOfDrinkingWaterOther,
    defecation_facility = this.defecationFacility,
    defecation_facility_other = this.defecationFacilityOther,
    facilitating_referral_service_status = this.facilitatingReferralServiceStatus,
    facilitating_social_assistance_status = this.facilitatingSocialAssistanceStatus,
    social_assistance_facilitation_options = this.socialAssistanceFacilitationOptions,
    social_assistance_facilitation_options_other = this.socialAssistanceFacilitationOptionsOther,
    pregnant_mother_status_id = this.breastfeedingMotherStatusId,
    next_visit_date = this.nextVisitDate,
    tpk_notes = this.tpkNotes,
    image_path_1 = this.imagePath1,
    image_path_2 = this.imagePath2,
    latitude = this.latitude,
    longitude = this.longitude
)
